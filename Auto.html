<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Live TON/USDT Auto Trading</title>
  <style>
    body { background:#000; color:#0f0; font-family:monospace; padding:20px; }
    h1 { color:#fff; }
    #price { font-size: 24px; margin-bottom: 10px; }
    .log { font-size:14px; color:#ccc; max-height:300px; overflow:auto; }
    .buy { color: #0f0; }
    .sell { color: #f00; }
  </style>
</head>
<body>
  <h1>TON/USDT Auto Trading</h1>
  <div id="price">Loading...</div>
  <div id="wallet">üí∞ Modal: $1000</div>
  <div class="log" id="log"></div>

  <script>
    let lastPrice = null;
    let balance = parseFloat(localStorage.getItem("balance")) || 1000;
    let lastSignal = localStorage.getItem("lastSignal") || "";

    document.getElementById("wallet").textContent = `üí∞ Modal: $${balance.toFixed(2)}`;

    async function fetchTONPrice() {
      const url = "https://api.dexscreener.com/latest/dex/search/?q=TON";
      try {
        const res = await fetch(url);
        const data = await res.json();

        const ton = data.pairs.find(p => p.pairName === "TON/USDT");
        if (!ton || !ton.priceUsd) throw new Error("Pair TON/USDT tidak ditemukan.");

        const price = parseFloat(ton.priceUsd);
        const priceText = `$${price.toFixed(4)}`;
        document.getElementById("price").textContent = `Live Price: ${priceText}`;

        if (lastPrice !== null) {
          const diff = price - lastPrice;

          if (diff <= -0.01 && lastSignal !== "BUY") {
            // Simulasi BUY
            balance += 5;
            lastSignal = "BUY";
            log("üü¢ BUY at " + priceText, "buy");
          } else if (diff >= 0.01 && lastSignal !== "SELL") {
            // Simulasi SELL
            balance -= 5;
            lastSignal = "SELL";
            log("üî¥ SELL at " + priceText, "sell");
          }

          localStorage.setItem("lastSignal", lastSignal);
          localStorage.setItem("balance", balance.toFixed(2));
          document.getElementById("wallet").textContent = `üí∞ Modal: $${balance.toFixed(2)}`;
        }

        lastPrice = price;
      } catch (e) {
        document.getElementById("price").textContent = "‚ùå Gagal ambil data.";
        log("‚ùå Error: " + e.message, "sell");
      }
    }

    function log(text, cls) {
      const el = document.getElementById("log");
      const time = new Date().toLocaleTimeString();
      const div = document.createElement("div");
      div.innerHTML = `[${time}] <span class="${cls}">${text}</span>`;
      el.prepend(div);
    }

    fetchTONPrice();
    setInterval(fetchTONPrice, 30000);
  </script>
</body>
</html>
