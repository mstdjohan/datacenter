<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>TON/USDT Auto Trading</title>
  <style>
    body { font-family: sans-serif; background: #111; color: #fff; padding: 20px; }
    #price { font-size: 1.5em; margin: 10px 0; }
    #log { white-space: pre-line; background: #222; padding: 10px; max-height: 200px; overflow-y: auto; }
    iframe { width: 100%; height: 400px; border: none; margin-top: 20px; }
  </style>
</head>
<body>
  <h1>TON/USDT Auto Trading</h1>
  <div>üí∞ Modal: <span id="capital">$1000.00</span></div>
  <div id="price">Harga: $--</div>
  <div id="log">Log:</div>

  <!-- TradingView Chart -->
  <iframe src="https://s.tradingview.com/widgetembed/?symbol=BINANCE:TONUSDT&interval=15&hidesidetoolbar=1&theme=dark&style=1&locale=id"
    allowtransparency="true" scrolling="no"></iframe>

  <script>
    const logDiv = document.getElementById('log');
    const priceDiv = document.getElementById('price');
    let capital = 1000;
    let lastPrice = null;
    let boughtAt = null;

    function log(msg) {
      const time = new Date().toLocaleTimeString();
      logDiv.textContent = `[${time}] ${msg}\n` + logDiv.textContent;
    }

    async function fetchPrice() {
      try {
        const res = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=toncoin&vs_currencies=usd');
        const data = await res.json();
        const price = data.toncoin.usd;
        priceDiv.textContent = `Harga: $${price.toFixed(4)}`;

        if (!lastPrice) lastPrice = price;

        // Logika beli/jual sederhana
        if (!boughtAt && price < lastPrice * 0.98) {
          boughtAt = price;
          log(`‚úÖ BUY at $${price.toFixed(4)}`);
        } else if (boughtAt && price > boughtAt * 1.02) {
          const profit = price - boughtAt;
          capital += profit;
          boughtAt = null;
          log(`üü© SELL at $${price.toFixed(4)} | üí∞ Profit: $${profit.toFixed(2)} | Modal: $${capital.toFixed(2)}`);
          document.getElementById('capital').textContent = `$${capital.toFixed(2)}`;
        }

        lastPrice = price;
      } catch (e) {
        log('‚ùå Gagal ambil data harga TON dari CoinGecko');
      }
    }

    // Fetch setiap 30 detik
    fetchPrice();
    setInterval(fetchPrice, 30000);
  </script>
</body>
</html>
